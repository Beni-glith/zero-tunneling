name: 🔐 Simple Obfuscation Scripts

on:
  workflow_dispatch:  # Bisa dijalankan manual
  push:
    branches: [ main ]

jobs:
  obfuscate:
    runs-on: ubuntu-latest
    steps:
    # 1. Checkout kode
    - uses: actions/checkout@v4

    # 2. Proses Obfuscation
    - name: Obfuscate Scripts
      run: |
        mkdir -p obfuscated
        for file in *.sh; do
          echo "🔐 Processing $file..."
          
          # Buat file baru dengan shebang
          echo '#!/bin/bash' > obfuscated/$file
          echo '# 🔒 Script terenkripsi - Jangan edit langsung' >> obfuscated/$file
          
          # Tambahkan perintah decode
          echo 'eval "$(base64 -d <<<"' >> obfuscated/$file
          
          # Encode script asli
          base64 $file >> obfuscated/$file
          
          # Tutup perintah eval
          echo '")"' >> obfuscated/$file
          
          # Berikan permission execute
          chmod +x obfuscated/$file
          echo "✅ Berhasil: obfuscated/$file"
        done

        # Verifikasi
        echo "📂 Hasil:"
        ls -la obfuscated/

    # 3. Upload hasil (opsional)
    - uses: actions/upload-artifact@v4
      if: success()
      with:
        name: obfuscated-scripts
        path: obfuscated/
