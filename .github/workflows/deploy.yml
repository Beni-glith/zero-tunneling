name: üîê Auto Encrypt-Push

on:
  workflow_dispatch:  # Manual trigger only

jobs:
  encrypt-push:
    runs-on: ubuntu-latest
    steps:
      # Step 1: Checkout code
      - uses: actions/checkout@v4

      # Step 2: Install SHC from source (working method)
      - name: Install SHC
        run: |
          sudo apt-get update
          sudo apt-get install -y build-essential git
          git clone https://github.com/neurobin/shc.git
          cd shc
          ./configure
          make
          sudo make install

      # Step 3: Encrypt scripts
      - name: Encrypt files
        run: |
          mkdir -p encrypted
          shc -f build.sh -o encrypted/build.sh
          shc -f payload.sh -o encrypted/payload.sh
          chmod +x encrypted/*

      # Step 4: Push changes
      - name: Commit and push
        run: |
          git config --global user.name "GitHub Bot"
          git config --global user.email "actions@github.com"
          git add encrypted
          git commit -m "üîí Auto-encrypted $(date +'%Y-%m-%d %T')"
          git push
