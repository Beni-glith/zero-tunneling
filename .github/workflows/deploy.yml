name: üîê Auto Encrypt-Push

on:
  workflow_dispatch:  # Manual trigger only

jobs:
  encrypt-push:
    runs-on: ubuntu-latest
    steps:
      # Step 1: Checkout code
      - uses: actions/checkout@v4

      # Step 2: Download pre-built SHC binary
      - name: Install SHC (pre-built)
        run: |
          wget https://github.com/neurobin/shc/files/936206/shc-3.8.9b.zip -O shc.zip
          unzip shc.zip
          chmod +x shc
          sudo mv shc /usr/local/bin/

      # Step 3: Encrypt scripts
      - name: Encrypt files
        run: |
          mkdir -p encrypted
          shc -f payload.sh -o encrypted/payload.sh
          shc -f build.sh -o encrypted/build.sh
          chmod +x encrypted/*

      # Step 4: Push changes
      - name: Commit and push
        run: |
          git config --global user.name "GitHub Bot"
          git config --global user.email "actions@github.com"
          git add encrypted
          git commit -m "üîí Auto-encrypted $(date +'%Y-%m-%d %T')"
          git push
